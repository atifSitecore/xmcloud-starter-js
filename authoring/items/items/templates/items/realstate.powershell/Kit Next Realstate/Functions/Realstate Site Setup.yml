---
ID: "e0a3b4c5-d6f7-8901-2cde-f34567890123"
Parent: "d9f2a3b4-c5e6-7890-1bcd-ef2345678901"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: /sitecore/system/Modules/PowerShell/Script Library/Kit Next Realstate/Functions/Realstate Site Setup
SharedFields:
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    function Invoke-Step {
        [CmdletBinding()]
        param(
            [Parameter(Mandatory = $true, Position = 0)]
            [Sitecore.XA.JSS.Foundation.Scaffolding.Models.CreateNewJSSSiteModel]$Model
        )
    
        begin {
            Write-Log "Kit Next Realstate - Post Site Setup Script" -Log "INFO"
            Write-Verbose "Kit Next Realstate - Post Site Setup Script"
        }
        
        process {
            [Item]$SiteLocation = $Model.SiteLocation
            $sitePath = "$($SiteLocation.Paths.Path)/$($Model.SiteName)"
            
            Write-Log "Setting up site at: $sitePath" -Log "INFO"
    
            # Configure the rendering host for kit-next-realstate
            Write-Log "Configuring rendering host" -Log "INFO"
            $siteGrouping = Get-Item -Path "$sitePath/Settings/Site Grouping/$($Model.SiteName)" -ErrorAction SilentlyContinue
            if ($siteGrouping) {
                $siteGrouping.RenderingHost = "kit-next-realstate"
                Write-Log "Set rendering host to kit-next-realstate" -Log "INFO"
            }
            
            # Set the start item to Home
            $homeItem = Get-Item -Path "$sitePath/Home" -ErrorAction SilentlyContinue
            if ($homeItem -and $siteGrouping) {
                $siteGrouping.StartItem = $homeItem.ID
                Write-Log "Set start item to Home" -Log "INFO"
            }
            
            # Create Page Design and link partial designs
            Write-Log "Creating Page Designs" -Log "INFO"
            $headerPartial = Get-Item -Path "$sitePath/Presentation/Partial Designs/Global/Header" -ErrorAction SilentlyContinue
            $footerPartial = Get-Item -Path "$sitePath/Presentation/Partial Designs/Global/Footer" -ErrorAction SilentlyContinue
            
            if ($headerPartial -and $footerPartial) {
                $pageDesignsPath = "$sitePath/Presentation/Page Designs"
                $defaultPageDesign = Get-Item -Path "$pageDesignsPath/Default" -ErrorAction SilentlyContinue
                
                if (-not $defaultPageDesign) {
                    $defaultPageDesign = New-Item -Path $pageDesignsPath -Name "Default" -ItemType "{1105B8F8-1E00-426B-BF1F-C840742D827B}"
                    Write-Log "Created Default Page Design" -Log "INFO"
                }
                
                $defaultPageDesign.PartialDesigns = "$($headerPartial.ID)|$($footerPartial.ID)"
                Write-Log "Linked Header and Footer to Default Page Design" -Log "INFO"
            }
            
            Write-Log "Real Estate site setup completed" -Log "INFO"
        }
        
        end {
            Write-Log "Kit Next Realstate - Post Site Setup Complete" -Log "INFO"
        }
    }
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20251206T000000Z
